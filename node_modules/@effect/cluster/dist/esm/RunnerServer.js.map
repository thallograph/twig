{"version":3,"file":"RunnerServer.js","names":["RpcServer","Effect","Fiber","constant","Layer","Mailbox","Option","Runtime","Message","MessageStorage","Reply","RunnerHealth","Runners","Sharding","ShardingConfig","constVoid","void","layerHandlers","Rpcs","toLayer","gen","sharding","storage","Ping","Notify","envelope","notify","_tag","IncomingRequest","respond","lastSentReply","none","IncomingEnvelope","persisted","request","replyEncoded","undefined","resume","reply","message","orDie","serialize","async","resume_","parent","getOrThrow","getCurrentFiber","runtime","make","context","currentContext","runtimeFlags","defaultRuntimeFlags","fiberRefs","getFiberRefs","onExit","exit","fiber","runFork","registerReplyHandler","addObserver","catchTag","constWaitUntilRead","interrupt","zipRight","send","Stream","flatMap","mailbox","unsafeOffer","as","pipe","onError","cause","failCause","forkScoped","interruptible","Envelope","waitUntilRead","layer","spanPrefix","disableTracing","provide","layerWithClients","provideMerge","layerRpc","layerClientOnly","layerNoop","updateService","config","runnerAddress"],"sources":["../../src/RunnerServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}