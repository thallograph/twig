{"version":3,"file":"RunnerServer.js","names":["RpcServer","_interopRequireWildcard","require","Effect","Fiber","_Function","Layer","Mailbox","Option","Runtime","Message","MessageStorage","Reply","RunnerHealth","Runners","Sharding","_ShardingConfig","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","constVoid","constant","void","layerHandlers","exports","Rpcs","toLayer","gen","sharding","storage","Ping","Notify","envelope","notify","_tag","IncomingRequest","respond","lastSentReply","none","IncomingEnvelope","persisted","request","replyEncoded","undefined","resume","reply","message","orDie","serialize","async","resume_","parent","getOrThrow","getCurrentFiber","runtime","make","context","currentContext","runtimeFlags","defaultRuntimeFlags","fiberRefs","getFiberRefs","onExit","exit","fiber","runFork","registerReplyHandler","addObserver","catchTag","constWaitUntilRead","interrupt","zipRight","send","Stream","flatMap","mailbox","unsafeOffer","as","pipe","onError","cause","failCause","forkScoped","interruptible","Envelope","waitUntilRead","layer","spanPrefix","disableTracing","provide","layerWithClients","provideMerge","layerRpc","layerClientOnly","layerNoop","updateService","ShardingConfig","config","runnerAddress"],"sources":["../../src/RunnerServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}