{"version":3,"file":"PersistedQueue.js","names":["Context","Effect","Exit","Iterable","Layer","Schema","Scope","TypeId","PersistedQueueFactory","Tag","make","options","flatMap","factory","makeFactory","gen","store","PersistedQueueStore","of","encodeUnknown","schema","decodeUnknown","succeed","offer","value","opts","element","id","crypto","randomUUID","as","name","isCustomId","undefined","take","f","uninterruptibleMask","fnUntraced","restore","scope","item","maxAttempts","pipe","extend","exit","attempts","close","layer","effect","ErrorTypeId","PersistedQueueError","TaggedError","message","String","cause","optional","Defect","layerStoreMemory","sync","ids","Set","queues","Map","getOrCreateQueue","queue","get","latch","unsafeMakeLatch","items","set","has","add","unsafeOpen","await","unsafeHead","delete","size","unsafeClose","addFinalizer","_tag","void","isInterrupted"],"sources":["../../src/PersistedQueue.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}