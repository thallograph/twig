{"version":3,"file":"httpServer.js","names":["Cookies","Etag","FetchHttpClient","Headers","App","IncomingMessage","Server","Error","ServerRequest","Socket","UrlParams","Config","Deferred","Effect","Exit","FiberSet","Inspectable","Layer","Option","Stream","BunContext","Platform","MultipartBun","make","options","gen","handlerStack","_request","_server","Response","status","server","Bun","serve","fetch","websocket","open","ws","unsafeDone","data","deferred","succeed","message","run","close","code","closeReason","closeDeferred","defaultCloseCodeIsError","fail","SocketCloseError","reason","void","addFinalizer","sync","stop","address","_tag","port","hostname","httpApp","middleware","runFork","makeRuntime","runtime","app","toHandled","request","response","resolve","makeResponse","handler","Promise","_reject","fiber","provideService","HttpServerRequest","ServerRequestImpl","removeHost","url","signal","addEventListener","interruptAsFork","clientAbortFiberId","once","acquireRelease","push","reload","pop","length","fields","headers","globalThis","isEmpty","cookies","header","toSetCookieHeaders","append","statusText","undefined","method","unsafeEjectStreamScope","body","key","value","entries","set","formData","toReadableStreamRuntime","stream","layerServer","scoped","HttpServer","layerContext","mergeAll","layer","layerWeak","layerTest","layerTestClient","pipe","provide","RequestInit","keepalive","provideMerge","layerConfig","flatMap","unwrap","wsDefaultRun","_","buffer","Class","source","bunServer","headersOverride","remoteAddressOverride","TypeId","constructor","toJSON","inspect","_id","originalUrl","modify","remoteAddress","toUpperCase","some","fromNullable","requestIP","fromInput","cachedCookies","parseHeader","cookie","fromReadableStream","cause","RequestError","description","textEffect","text","runSync","cached","tryPromise","try","catch","json","tryMap","JSON","parse","urlParamsBody","URLSearchParams","multipartEffect","multipart","persisted","multipartStream","arrayBufferEffect","arrayBuffer","upgrade","all","makeSemaphore","semaphore","async","resume","success","map","await","write","chunk","sendText","isCloseEvent","sendBinary","writer","runRaw","fnUntraced","opts","result","isEffect","forEach","onOpen","join","onExit","exit","raceFirst","withPermits","encoder","TextEncoder","encode","of","index","indexOf","slice","requestSource","self"],"sources":["../../../src/internal/httpServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}