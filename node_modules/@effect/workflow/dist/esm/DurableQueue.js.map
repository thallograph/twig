{"version":3,"file":"DurableQueue.js","names":["PersistedQueue","Context","Effect","Layer","Schedule","Schema","Activity","DurableDeferred","TypeId","make","options","name","payloadSchema","isSchema","payload","Struct","idempotencyKey","deferred","success","error","queueSchemas","WeakMap","getQueueSchema","schema","get","token","String","traceId","spanId","sampled","Boolean","set","process","fnUntraced","self","queueName","queue","id","successSchema","errorSchema","useSpan","captureStackTrace","attributes","span","offer","pipe","tapErrorCause","logWarning","catchTag","die","retry","retrySchedule","defaultRetrySchedule","orDie","annotateLogs","package","module","fiber","await","exponential","union","spaced","makeWorker","f","concurrency","worker","take","item_","item","exit","flatMap","done","asVoid","withSpan","parent","_tag","context","empty","catchAllCause","forever","replicateEffect","discard","never","scopedDiscard","forkScoped"],"sources":["../../src/DurableQueue.ts"],"sourcesContent":[null],"mappings":"AAAA;;;AAGA,OAAO,KAAKA,cAAc,MAAM,qCAAqC;AACrE,OAAO,KAAKC,OAAO,MAAM,gBAAgB;AACzC,OAAO,KAAKC,MAAM,MAAM,eAAe;AACvC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC,OAAO,KAAKC,QAAQ,MAAM,iBAAiB;AAC3C,OAAO,KAAKC,MAAM,MAAM,eAAe;AACvC,OAAO,KAAKC,QAAQ,MAAM,eAAe;AACzC,OAAO,KAAKC,eAAe,MAAM,sBAAsB;AASvD;;;;AAIA,OAAO,MAAMC,MAAM,GAAW,gCAAgC;AAkB9D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA,OAAO,MAAMC,IAAI,GAKfC,OAQC,KAKG;EACJ,CAACF,MAAM,GAAGA,MAAM;EAChBG,IAAI,EAAED,OAAO,CAACC,IAAI;EAClBC,aAAa,EAAEP,MAAM,CAACQ,QAAQ,CAACH,OAAO,CAACI,OAAO,CAAC,GAAGJ,OAAO,CAACI,OAAO,GAAGT,MAAM,CAACU,MAAM,CAACL,OAAO,CAACI,OAAO,CAAQ;EACzGE,cAAc,EAAEN,OAAO,CAACM,cAAqB;EAC7CC,QAAQ,EAAEV,eAAe,CAACE,IAAI,CAAC,gBAAgBC,OAAO,CAACC,IAAI,EAAE,EAAE;IAC7DO,OAAO,EAAER,OAAO,CAACQ,OAAO;IACxBC,KAAK,EAAET,OAAO,CAACS;GAChB;CACF,CAAC;AAEF,MAAMC,YAAY,gBAAG,IAAIC,OAAO,EAAwC;AACxE,MAAMC,cAAc,GAClBR,OAAgB,IAOb;EACH,IAAIS,MAAM,GAAGH,YAAY,CAACI,GAAG,CAACV,OAAO,CAAC;EACtC,IAAI,CAACS,MAAM,EAAE;IACXA,MAAM,GAAGlB,MAAM,CAACU,MAAM,CAAC;MACrBU,KAAK,EAAEpB,MAAM,CAACqB,MAAM;MACpBC,OAAO,EAAEtB,MAAM,CAACqB,MAAM;MACtBE,MAAM,EAAEvB,MAAM,CAACqB,MAAM;MACrBG,OAAO,EAAExB,MAAM,CAACyB,OAAO;MACvBhB;KACD,CAAC;IACFM,YAAY,CAACW,GAAG,CAACjB,OAAO,EAAES,MAAM,CAAC;EACnC;EACA,OAAOA,MAAa;AACtB,CAAC;AAED;;;;AAIA,OAAO,MAAMS,OAAO,gBAmBhB9B,MAAM,CAAC+B,UAAU,CAAC,WAIpBC,IAA2C,EAAEpB,OAAwB,EAAEJ,OAExE;EACC,MAAMyB,SAAS,GAAG,gBAAgBD,IAAI,CAACvB,IAAI,EAAE;EAC7C,MAAMyB,KAAK,GAAG,OAAOpC,cAAc,CAACS,IAAI,CAAC;IACvCE,IAAI,EAAEwB,SAAS;IACfZ,MAAM,EAAED,cAAc,CAACY,IAAI,CAACtB,aAAa;GAC1C,CAAC;EACF,MAAMyB,EAAE,GAAG,OAAO/B,QAAQ,CAACU,cAAc,CAAC,GAAGmB,SAAS,IAAID,IAAI,CAAClB,cAAc,CAACF,OAAO,CAAC,EAAE,CAAC;EAEzF,MAAMG,QAAQ,GAAGV,eAAe,CAACE,IAAI,CAAC,GAAGyB,IAAI,CAACjB,QAAQ,CAACN,IAAI,IAAI0B,EAAE,EAAE,EAAE;IACnEnB,OAAO,EAAEgB,IAAI,CAACjB,QAAQ,CAACqB,aAAa;IACpCnB,KAAK,EAAEe,IAAI,CAACjB,QAAQ,CAACsB;GACtB,CAAC;EACF,MAAMd,KAAK,GAAG,OAAOlB,eAAe,CAACkB,KAAK,CAACR,QAAQ,CAAC;EAEpD,OAAOf,MAAM,CAACsC,OAAO,CAAC,gBAAgBN,IAAI,CAACvB,IAAI,UAAU,EAAE;IACzD8B,iBAAiB,EAAE,KAAK;IACxBC,UAAU,EAAE;MAAEL;IAAE;GACjB,EAAGM,IAAI,IACNP,KAAK,CAACQ,KAAK,CAAC;IACVnB,KAAK;IACLX,OAAO;IACPa,OAAO,EAAEgB,IAAI,CAAChB,OAAO;IACrBC,MAAM,EAAEe,IAAI,CAACf,MAAM;IACnBC,OAAO,EAAEc,IAAI,CAACd;GACR,EAAE;IAAEQ;EAAE,CAAE,CAAC,CAACQ,IAAI,CACpB3C,MAAM,CAAC4C,aAAa,CAAC5C,MAAM,CAAC6C,UAAU,CAAC,EACvC7C,MAAM,CAAC8C,QAAQ,CAAC,YAAY,EAAE9C,MAAM,CAAC+C,GAAG,CAAC,EACzC/C,MAAM,CAACgD,KAAK,CAACxC,OAAO,EAAEyC,aAAa,IAAIC,oBAAoB,CAAC,EAC5DlD,MAAM,CAACmD,KAAK,EACZnD,MAAM,CAACoD,YAAY,CAAC;IAClBC,OAAO,EAAE,kBAAkB;IAC3BC,MAAM,EAAE,cAAc;IACtBC,KAAK,EAAE,SAAS;IAChBtB,SAAS,EAAED,IAAI,CAACvB;GACjB,CAAC,CACH,CAAC;EAEJ,OAAO,OAAOJ,eAAe,CAACmD,KAAK,CAACzC,QAAQ,CAAC;AAC/C,CAAC,CAAC;AAEF,MAAMmC,oBAAoB,gBAAGhD,QAAQ,CAACuD,WAAW,CAAC,GAAG,EAAE,GAAG,CAAC,CAACd,IAAI,cAC9DzC,QAAQ,CAACwD,KAAK,cAACxD,QAAQ,CAACyD,MAAM,CAAC,UAAU,CAAC,CAAC,CAC5C;AAED;;;;AAIA,OAAO,MAAMC,UAAU,gBAkBnB5D,MAAM,CAAC+B,UAAU,CAAC,WAMpBC,IAA2C,EAC3C6B,CAAiF,EACjFrD,OAEC;EAED,MAAM0B,KAAK,GAAG,OAAOpC,cAAc,CAACS,IAAI,CAAC;IACvCE,IAAI,EAAE,gBAAgBuB,IAAI,CAACvB,IAAI,EAAE;IACjCY,MAAM,EAAED,cAAc,CAACY,IAAI,CAACtB,aAAa;GAC1C,CAAC;EACF,MAAMoD,WAAW,GAAGtD,OAAO,EAAEsD,WAAW,IAAI,CAAC;EAE7C,MAAMC,MAAM,GAAG7B,KAAK,CAAC8B,IAAI,CAAEC,KAAK,IAAI;IAClC,MAAMC,IAAI,GAAGD,KAMZ;IACD,OAAOJ,CAAC,CAACK,IAAI,CAACtD,OAAO,CAAC,CAAC+B,IAAI,CACzB3C,MAAM,CAACmE,IAAI,EACXnE,MAAM,CAACoE,OAAO,CAAED,IAAI,IAClB9D,eAAe,CAACgE,IAAI,CAACrC,IAAI,CAACjB,QAAQ,EAAE;MAClCQ,KAAK,EAAE2C,IAAI,CAAC3C,KAAK;MACjB4C;KACD,CAAC,CACH,EACDnE,MAAM,CAACsE,MAAM,EACbtE,MAAM,CAACuE,QAAQ,CAAC,gBAAgBvC,IAAI,CAACvB,IAAI,SAAS,EAAE;MAClD8B,iBAAiB,EAAE,KAAK;MACxBiC,MAAM,EAAE;QACNC,IAAI,EAAE,cAAc;QACpBhD,OAAO,EAAEyC,IAAI,CAACzC,OAAO;QACrBC,MAAM,EAAEwC,IAAI,CAACxC,MAAM;QACnBC,OAAO,EAAEuC,IAAI,CAACvC,OAAO;QACrB+C,OAAO,EAAE3E,OAAO,CAAC4E,KAAK;;KAEzB,CAAC,CACH;EACH,CAAC,CAAC,CAAChC,IAAI,CACL3C,MAAM,CAAC4E,aAAa,CAAC5E,MAAM,CAAC6C,UAAU,CAAC,EACvC7C,MAAM,CAAC6E,OAAO,EACd7E,MAAM,CAACoD,YAAY,CAAC;IAClBC,OAAO,EAAE,kBAAkB;IAC3BC,MAAM,EAAE,cAAc;IACtBC,KAAK,EAAE;GACR,CAAC,CACH;EAED,OAAOvD,MAAM,CAAC8E,eAAe,CAACf,MAAM,EAAED,WAAW,EAAE;IAAEA,WAAW;IAAEiB,OAAO,EAAE;EAAI,CAAE,CAAC;EAClF,OAAO,OAAO/E,MAAM,CAACgF,KAAK;AAC5B,CAAC,CAAC;AAEF;;;;AAIA,OAAO,MAAMjB,MAAM,GAoBfA,CAAC/B,IAAI,EAAE6B,CAAC,EAAErD,OAAO,KAAKP,KAAK,CAACgF,aAAa,CAACjF,MAAM,CAACkF,UAAU,CAACtB,UAAU,CAAC5B,IAAI,EAAE6B,CAAC,EAAErD,OAAO,CAAC,CAAC,CAAC","ignoreList":[]}